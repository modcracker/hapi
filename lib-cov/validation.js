/* automatically generated by JSCoverage - do not edit */
if (typeof _$jscoverage === 'undefined') _$jscoverage = {};
if (! _$jscoverage['validation.js']) {
  _$jscoverage['validation.js'] = [];
  _$jscoverage['validation.js'][8] = 0;
  _$jscoverage['validation.js'][9] = 0;
  _$jscoverage['validation.js'][14] = 0;
  _$jscoverage['validation.js'][19] = 0;
  _$jscoverage['validation.js'][20] = 0;
  _$jscoverage['validation.js'][22] = 0;
  _$jscoverage['validation.js'][24] = 0;
  _$jscoverage['validation.js'][27] = 0;
  _$jscoverage['validation.js'][29] = 0;
  _$jscoverage['validation.js'][31] = 0;
  _$jscoverage['validation.js'][34] = 0;
  _$jscoverage['validation.js'][69] = 0;
  _$jscoverage['validation.js'][71] = 0;
  _$jscoverage['validation.js'][73] = 0;
  _$jscoverage['validation.js'][76] = 0;
  _$jscoverage['validation.js'][77] = 0;
  _$jscoverage['validation.js'][81] = 0;
  _$jscoverage['validation.js'][83] = 0;
  _$jscoverage['validation.js'][85] = 0;
  _$jscoverage['validation.js'][87] = 0;
  _$jscoverage['validation.js'][89] = 0;
  _$jscoverage['validation.js'][90] = 0;
  _$jscoverage['validation.js'][91] = 0;
  _$jscoverage['validation.js'][97] = 0;
  _$jscoverage['validation.js'][101] = 0;
  _$jscoverage['validation.js'][103] = 0;
  _$jscoverage['validation.js'][107] = 0;
  _$jscoverage['validation.js'][109] = 0;
  _$jscoverage['validation.js'][110] = 0;
  _$jscoverage['validation.js'][111] = 0;
  _$jscoverage['validation.js'][116] = 0;
  _$jscoverage['validation.js'][118] = 0;
  _$jscoverage['validation.js'][119] = 0;
  _$jscoverage['validation.js'][120] = 0;
  _$jscoverage['validation.js'][125] = 0;
  _$jscoverage['validation.js'][129] = 0;
  _$jscoverage['validation.js'][133] = 0;
  _$jscoverage['validation.js'][136] = 0;
  _$jscoverage['validation.js'][137] = 0;
  _$jscoverage['validation.js'][138] = 0;
  _$jscoverage['validation.js'][143] = 0;
  _$jscoverage['validation.js'][145] = 0;
  _$jscoverage['validation.js'][146] = 0;
  _$jscoverage['validation.js'][148] = 0;
  _$jscoverage['validation.js'][149] = 0;
  _$jscoverage['validation.js'][150] = 0;
  _$jscoverage['validation.js'][156] = 0;
  _$jscoverage['validation.js'][158] = 0;
  _$jscoverage['validation.js'][163] = 0;
  _$jscoverage['validation.js'][164] = 0;
  _$jscoverage['validation.js'][165] = 0;
  _$jscoverage['validation.js'][170] = 0;
  _$jscoverage['validation.js'][172] = 0;
  _$jscoverage['validation.js'][173] = 0;
  _$jscoverage['validation.js'][175] = 0;
  _$jscoverage['validation.js'][176] = 0;
  _$jscoverage['validation.js'][177] = 0;
  _$jscoverage['validation.js'][185] = 0;
  _$jscoverage['validation.js'][187] = 0;
  _$jscoverage['validation.js'][191] = 0;
  _$jscoverage['validation.js'][196] = 0;
  _$jscoverage['validation.js'][200] = 0;
  _$jscoverage['validation.js'][204] = 0;
  _$jscoverage['validation.js'][206] = 0;
  _$jscoverage['validation.js'][210] = 0;
  _$jscoverage['validation.js'][216] = 0;
  _$jscoverage['validation.js'][218] = 0;
  _$jscoverage['validation.js'][220] = 0;
  _$jscoverage['validation.js'][221] = 0;
  _$jscoverage['validation.js'][222] = 0;
  _$jscoverage['validation.js'][223] = 0;
  _$jscoverage['validation.js'][224] = 0;
  _$jscoverage['validation.js'][225] = 0;
  _$jscoverage['validation.js'][228] = 0;
  _$jscoverage['validation.js'][230] = 0;
  _$jscoverage['validation.js'][233] = 0;
  _$jscoverage['validation.js'][234] = 0;
  _$jscoverage['validation.js'][236] = 0;
  _$jscoverage['validation.js'][238] = 0;
  _$jscoverage['validation.js'][241] = 0;
  _$jscoverage['validation.js'][242] = 0;
  _$jscoverage['validation.js'][243] = 0;
  _$jscoverage['validation.js'][245] = 0;
  _$jscoverage['validation.js'][247] = 0;
  _$jscoverage['validation.js'][250] = 0;
  _$jscoverage['validation.js'][252] = 0;
  _$jscoverage['validation.js'][255] = 0;
  _$jscoverage['validation.js'][257] = 0;
  _$jscoverage['validation.js'][260] = 0;
  _$jscoverage['validation.js'][261] = 0;
  _$jscoverage['validation.js'][265] = 0;
  _$jscoverage['validation.js'][267] = 0;
  _$jscoverage['validation.js'][270] = 0;
  _$jscoverage['validation.js'][271] = 0;
  _$jscoverage['validation.js'][273] = 0;
  _$jscoverage['validation.js'][275] = 0;
  _$jscoverage['validation.js'][278] = 0;
  _$jscoverage['validation.js'][279] = 0;
  _$jscoverage['validation.js'][280] = 0;
  _$jscoverage['validation.js'][282] = 0;
  _$jscoverage['validation.js'][284] = 0;
  _$jscoverage['validation.js'][287] = 0;
  _$jscoverage['validation.js'][289] = 0;
  _$jscoverage['validation.js'][292] = 0;
  _$jscoverage['validation.js'][294] = 0;
  _$jscoverage['validation.js'][297] = 0;
  _$jscoverage['validation.js'][298] = 0;
  _$jscoverage['validation.js'][301] = 0;
}
_$jscoverage['validation.js'][8]++;
var Utils = require("./utils");
_$jscoverage['validation.js'][9]++;
var Err = require("./error");
_$jscoverage['validation.js'][14]++;
var internals = {};
_$jscoverage['validation.js'][19]++;
exports.validateQuery = (function (req, config, callback) {
  _$jscoverage['validation.js'][20]++;
  var handleResponse;
  _$jscoverage['validation.js'][22]++;
  if (parameters === null) {
    _$jscoverage['validation.js'][24]++;
    return callback(null);
  }
  _$jscoverage['validation.js'][27]++;
  Types.validateCollection(req, config, handleQueryResponse = (function (isInvalid) {
  _$jscoverage['validation.js'][29]++;
  if (isInvalid) {
    _$jscoverage['validation.js'][31]++;
    callback(Err.badRequest("Unknown parameter: " + i));
  }
  else {
    _$jscoverage['validation.js'][34]++;
    callback(null);
  }
}));
});
_$jscoverage['validation.js'][69]++;
exports.validateData = (function (req, definition, callback) {
  _$jscoverage['validation.js'][71]++;
  if (definition === null) {
    _$jscoverage['validation.js'][73]++;
    return callback(null);
  }
  _$jscoverage['validation.js'][76]++;
  var isInvalid = false;
  _$jscoverage['validation.js'][77]++;
  var err = "";
  _$jscoverage['validation.js'][81]++;
  for (var i in definition) {
    _$jscoverage['validation.js'][83]++;
    if (definition.hasOwnProperty(i)) {
      _$jscoverage['validation.js'][85]++;
      if (definition[i].required === true) {
        _$jscoverage['validation.js'][87]++;
        if (req.hapi.payload[i] === undefined) {
          _$jscoverage['validation.js'][89]++;
          err = "missing required parameter";
          _$jscoverage['validation.js'][90]++;
          isInvalid = true;
          _$jscoverage['validation.js'][91]++;
          break;
        }
      }
    }
}
  _$jscoverage['validation.js'][97]++;
  if (isInvalid === false) {
    _$jscoverage['validation.js'][101]++;
    for (var i in req.hapi.payload) {
      _$jscoverage['validation.js'][103]++;
      if (req.hapi.payload.hasOwnProperty(i)) {
        _$jscoverage['validation.js'][107]++;
        if (definition[i] === undefined) {
          _$jscoverage['validation.js'][109]++;
          err = "unknown parameter";
          _$jscoverage['validation.js'][110]++;
          isInvalid = true;
          _$jscoverage['validation.js'][111]++;
          break;
        }
        _$jscoverage['validation.js'][116]++;
        if (definition[i].set === false) {
          _$jscoverage['validation.js'][118]++;
          err = "forbidden parameter";
          _$jscoverage['validation.js'][119]++;
          isInvalid = true;
          _$jscoverage['validation.js'][120]++;
          break;
        }
        _$jscoverage['validation.js'][125]++;
        if (definition[i].array === true) {
          _$jscoverage['validation.js'][129]++;
          if (req.hapi.payload[i] instanceof Array) {
            _$jscoverage['validation.js'][133]++;
            if (req.hapi.payload[i].length === 0 && definition[i].empty !== true) {
              _$jscoverage['validation.js'][136]++;
              err = "empty array not allowed";
              _$jscoverage['validation.js'][137]++;
              isInvalid = true;
              _$jscoverage['validation.js'][138]++;
              break;
            }
            _$jscoverage['validation.js'][143]++;
            for (var a = 0, al = req.hapi.payload[i].length; a < al; ++a) {
              _$jscoverage['validation.js'][145]++;
              var message = internals.checkValue(req.hapi.payload[i][a], definition[i], false);
              _$jscoverage['validation.js'][146]++;
              if (message) {
                _$jscoverage['validation.js'][148]++;
                err = "invalid array value - " + message;
                _$jscoverage['validation.js'][149]++;
                isInvalid = true;
                _$jscoverage['validation.js'][150]++;
                break;
              }
}
            _$jscoverage['validation.js'][156]++;
            if (isInvalid === true) {
              _$jscoverage['validation.js'][158]++;
              break;
            }
          }
          else {
            _$jscoverage['validation.js'][163]++;
            err = "array value required";
            _$jscoverage['validation.js'][164]++;
            isInvalid = true;
            _$jscoverage['validation.js'][165]++;
            break;
          }
        }
        else {
          _$jscoverage['validation.js'][170]++;
          if (definition[i].type !== "any") {
            _$jscoverage['validation.js'][172]++;
            var result = internals.checkValue(req.hapi.payload[i], definition[i], definition[i].empty);
            _$jscoverage['validation.js'][173]++;
            if (result) {
              _$jscoverage['validation.js'][175]++;
              err = result;
              _$jscoverage['validation.js'][176]++;
              isInvalid = true;
              _$jscoverage['validation.js'][177]++;
              break;
            }
          }
        }
      }
}
  }
  _$jscoverage['validation.js'][185]++;
  if (isInvalid) {
    _$jscoverage['validation.js'][187]++;
    callback(Err.badRequest("'" + i + "': " + err));
  }
  else {
    _$jscoverage['validation.js'][191]++;
    callback(null);
  }
});
_$jscoverage['validation.js'][196]++;
internals.checkValue = (function (value, definition, isEmptyAllowed) {
  _$jscoverage['validation.js'][200]++;
  if (value === null || (typeof value === "number" && isNaN(value)) || (typeof value === "string" && value === "")) {
    _$jscoverage['validation.js'][204]++;
    if (isEmptyAllowed !== true) {
      _$jscoverage['validation.js'][206]++;
      return "empty value not allowed";
    }
    else {
      _$jscoverage['validation.js'][210]++;
      return "";
    }
  }
  _$jscoverage['validation.js'][216]++;
  var isValid = false;
  _$jscoverage['validation.js'][218]++;
  switch (definition.type) {
  case "string":
    _$jscoverage['validation.js'][220]++;
    isValid = (typeof value === "string");
    _$jscoverage['validation.js'][220]++;
    break;
  case "id":
    _$jscoverage['validation.js'][221]++;
    isValid = (typeof value === "string");
    _$jscoverage['validation.js'][221]++;
    break;
  case "number":
    _$jscoverage['validation.js'][222]++;
    isValid = (typeof value === "number");
    _$jscoverage['validation.js'][222]++;
    break;
  case "enum":
    _$jscoverage['validation.js'][223]++;
    isValid = (typeof value === "string" && definition.values && definition.values[value] > 0);
    _$jscoverage['validation.js'][223]++;
    break;
  case "object":
    _$jscoverage['validation.js'][224]++;
    isValid = (typeof value === "object");
    _$jscoverage['validation.js'][224]++;
    break;
  case "email":
    _$jscoverage['validation.js'][225]++;
    isValid = Utils.checkEmail(value);
    _$jscoverage['validation.js'][225]++;
    break;
  case "date":
    _$jscoverage['validation.js'][228]++;
    if (typeof value !== "string") {
      _$jscoverage['validation.js'][230]++;
      return "value must be a string";
    }
    _$jscoverage['validation.js'][233]++;
    var dateRegex = /^([12]\d\d\d)-([01]\d)-([0123]\d)$/;
    _$jscoverage['validation.js'][234]++;
    var date = dateRegex.exec(value);
    _$jscoverage['validation.js'][236]++;
    if (date === null || date.length !== 4) {
      _$jscoverage['validation.js'][238]++;
      return "invalid date string format";
    }
    _$jscoverage['validation.js'][241]++;
    var year = parseInt(date[1], 10);
    _$jscoverage['validation.js'][242]++;
    var month = parseInt(date[2], 10);
    _$jscoverage['validation.js'][243]++;
    var day = parseInt(date[3], 10);
    _$jscoverage['validation.js'][245]++;
    if (year < 1970 || year > 3000) {
      _$jscoverage['validation.js'][247]++;
      return "invalid year: " + date[1];
    }
    _$jscoverage['validation.js'][250]++;
    if (month < 1 || month > 12) {
      _$jscoverage['validation.js'][252]++;
      return "invalid month: " + date[2];
    }
    _$jscoverage['validation.js'][255]++;
    if (day < 1 || day > 31) {
      _$jscoverage['validation.js'][257]++;
      return "invalid day: " + date[3];
    }
    _$jscoverage['validation.js'][260]++;
    isValid = true;
    _$jscoverage['validation.js'][261]++;
    break;
  case "time":
    _$jscoverage['validation.js'][265]++;
    if (typeof value !== "string") {
      _$jscoverage['validation.js'][267]++;
      return "value must be a string";
    }
    _$jscoverage['validation.js'][270]++;
    var timeRegex = /^([012]\d):([012345]\d):([012345]\d)$/;
    _$jscoverage['validation.js'][271]++;
    var time = timeRegex.exec(value);
    _$jscoverage['validation.js'][273]++;
    if (time === null || time.length !== 4) {
      _$jscoverage['validation.js'][275]++;
      return "invalid time string format";
    }
    _$jscoverage['validation.js'][278]++;
    var hour = parseInt(time[1], 10);
    _$jscoverage['validation.js'][279]++;
    var minute = parseInt(time[2], 10);
    _$jscoverage['validation.js'][280]++;
    var second = parseInt(time[3], 10);
    _$jscoverage['validation.js'][282]++;
    if (hour < 0 || hour > 23) {
      _$jscoverage['validation.js'][284]++;
      return "invalid hour";
    }
    _$jscoverage['validation.js'][287]++;
    if (minute < 0 || minute > 59) {
      _$jscoverage['validation.js'][289]++;
      return "invalid minute";
    }
    _$jscoverage['validation.js'][292]++;
    if (second < 0 || second > 59) {
      _$jscoverage['validation.js'][294]++;
      return "invalid second";
    }
    _$jscoverage['validation.js'][297]++;
    isValid = true;
    _$jscoverage['validation.js'][298]++;
    break;
  }
  _$jscoverage['validation.js'][301]++;
  return (isValid? "": "bad value type, " + definition.type + " expected");
});
_$jscoverage['validation.js'].source = ["/*","* Copyright (c) 2012 Walmart. All rights reserved. Copyrights licensed under the New BSD License.","* See LICENSE file included with this code project for license terms.","*/","","// Load modules","","var Utils = require('./utils');","var Err = require('./error');","","","// Declare internals","","var internals = {};","","","// Validate query","","exports.validateQuery = function (req, config, callback) {","    var handleResponse;","    ","    if (parameters === null) {","        ","        return callback(null)","    }","    ","    Types.validateCollection(req, config, handleQueryResponse = function (isInvalid) {","        ","        if (isInvalid) {","            ","            callback(Err.badRequest('Unknown parameter: ' + i));","        } else {","            ","            callback(null);","        }","    })","","    // if (parameters === null) {","","    //     return callback(null);","    // }","","    // var isInvalid = false;","    // for (var i in req.query) {","","    //     if (req.query.hasOwnProperty(i)) {","","    //         if (parameters[i] !== true) {","","    //             isInvalid = true;","    //             break;","    //         }","    //     }","    // }","","    // if (isInvalid) {","","    //     callback(Err.badRequest('Unknown parameter: ' + i));","    // }","    // else {","","    //     callback(null);","    // }","};","","","// Validate payload schema","","exports.validateData = function (req, definition, callback) {","","    if (definition === null) {","","        return callback(null);","    }","","    var isInvalid = false;","    var err = '';","","    // Check required variables","","    for (var i in definition) {","","        if (definition.hasOwnProperty(i)) {","","            if (definition[i].required === true) {","","                if (req.hapi.payload[i] === undefined) {","","                    err = 'missing required parameter';","                    isInvalid = true;","                    break;","                }","            }","        }","    }","","    if (isInvalid === false) {","","        // Check each incoming variable","","        for (var i in req.hapi.payload) {","","            if (req.hapi.payload.hasOwnProperty(i)) {","","                // Lookup variable definition","","                if (definition[i] === undefined) {","","                    err = 'unknown parameter';","                    isInvalid = true;","                    break;","                }","","                // Check if update allowed","","                if (definition[i].set === false) {","","                    err = 'forbidden parameter';","                    isInvalid = true;","                    break;","                }","","                // Check for array type","","                if (definition[i].array === true) {","","                    // If variable is an array","","                    if (req.hapi.payload[i] instanceof Array) {","","                        // Check for empty array","","                        if (req.hapi.payload[i].length === 0 &amp;&amp;","                            definition[i].empty !== true) {","","                            err = 'empty array not allowed';","                            isInvalid = true;","                            break;","                        }","","                        // For each array element, check type","","                        for (var a = 0, al = req.hapi.payload[i].length; a &lt; al; ++a) {","","                            var message = internals.checkValue(req.hapi.payload[i][a], definition[i], false);","                            if (message) {","","                                err = 'invalid array value - ' + message;","                                isInvalid = true;","                                break;","                            }","                        }","","                        // Double break","","                        if (isInvalid === true) {","","                            break;","                        }","                    }","                    else {","","                        err = 'array value required';","                        isInvalid = true;","                        break;","                    }","                }","                else {","","                    if (definition[i].type !== 'any') {","","                        var result = internals.checkValue(req.hapi.payload[i], definition[i], definition[i].empty);","                        if (result) {","","                            err = result;","                            isInvalid = true;","                            break;","                        }","                    }","                }","            }","        }","    }","","    if (isInvalid) {","","        callback(Err.badRequest('\\'' + i + '\\': ' + err));","    }","    else {","","        callback(null);","    }","};","","","internals.checkValue = function (value, definition, isEmptyAllowed) {","","    // Check for empty value","","    if (value === null ||","        (typeof value === 'number' &amp;&amp; isNaN(value)) ||","        (typeof value === 'string' &amp;&amp; value === '')) {","","        if (isEmptyAllowed !== true) {","","            return 'empty value not allowed';","        }","        else {","","            return '';","        }","    }","","    // Check types","","    var isValid = false;","","    switch (definition.type) {","","        case 'string': isValid = (typeof value === 'string'); break;","        case 'id': isValid = (typeof value === 'string'); break;","        case 'number': isValid = (typeof value === 'number'); break;","        case 'enum': isValid = (typeof value === 'string' &amp;&amp; definition.values &amp;&amp; definition.values[value] &gt; 0); break;","        case 'object': isValid = (typeof value === 'object'); break;","        case 'email': isValid = Utils.checkEmail(value); break;","        case 'date':","","            if (typeof value !== 'string') {","","                return 'value must be a string';","            }","","            var dateRegex = /^([12]\\d\\d\\d)-([01]\\d)-([0123]\\d)$/;","            var date = dateRegex.exec(value);","","            if (date === null || date.length !== 4) {","","                return 'invalid date string format';","            }","","            var year = parseInt(date[1], 10);","            var month = parseInt(date[2], 10);","            var day = parseInt(date[3], 10);","","            if (year &lt; 1970 || year &gt; 3000) {","","                return 'invalid year: ' + date[1];","            }","","            if (month &lt; 1 || month &gt; 12) {","","                return 'invalid month: ' + date[2];","            }","","            if (day &lt; 1 || day &gt; 31) {","","                return 'invalid day: ' + date[3];","            }","","            isValid = true;","            break;","","        case 'time':","","            if (typeof value !== 'string') {","","                return 'value must be a string';","            }","","            var timeRegex = /^([012]\\d):([012345]\\d):([012345]\\d)$/;","            var time = timeRegex.exec(value);","","            if (time === null || time.length !== 4) {","","                return 'invalid time string format';","            }","","            var hour = parseInt(time[1], 10);","            var minute = parseInt(time[2], 10);","            var second = parseInt(time[3], 10);","","            if (hour &lt; 0 || hour &gt; 23) {","","                return 'invalid hour';","            }","","            if (minute &lt; 0 || minute &gt; 59) {","","                return 'invalid minute';","            }","","            if (second &lt; 0 || second &gt; 59) {","","                return 'invalid second';","            }","","            isValid = true;","            break;","    }","","    return (isValid ? '' : 'bad value type, ' + definition.type + ' expected');","};",""];
